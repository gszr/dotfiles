# vim: filetype=zsh
# some git-related functions

function git_is_repo() {
  [ -d .git ]
}

function git_is_dirty() {
  git update-index -q --ignore-submodules --refresh
  ! git diff-files --quiet --ignore-submodules
}

function git_not_staged() {
  git diff --quiet --cached
}

function git_get_status() {
  if ! git_not_staged; then
    echo "staged"
    return
  fi
  if git_is_dirty; then
    echo "dirty"
    return
  else
    echo "clean"
    return
  fi
}

function git_num_ahead() {
  git rev-list --count @{u}..
}

function git_get_branch() {
  git symbolic-ref --short HEAD
}

function git_get_info() {
  echo "(git:`git_get_branch`:`git_get_status`:`git_num_ahead`)"
}

